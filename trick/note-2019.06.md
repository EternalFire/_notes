

- [2019.06.10](#20190610)
- [2019.06.09](#20190609)
- [2019.06.08](#20190608)
- [2019.06.07](#20190607)
- [2019.06.06](#20190606)
- [2019.06.05](#20190605)
- [2019.06.04](#20190604)
- [2019.06.03](#20190603)
- [2019.06.02](#20190602)
- [2019.06.01](#20190601)

---

## 2019.06.10

滑动条(slider)与进度条(progress):

都有取值范围.

滑动条, 可以手动控制滑块, 设置当前值.

进度条, 值是自动向边界变化.

下拉选择(combo), 可以表示单项选择, 只显示选中的选项, 其他选项隐藏.

单选按钮(radio), 也可以表示单项选择项, 所有选项都会显示.


<limits.h>: INT_MAX, INT_MIN, ...

构建函数(constructor) 与 初始化函数(initialzation)分离, 这样在其他地方也可以使用初始化函数.

---

## 2019.06.09


Xcode Help, 搜索 "Build settings reference", 可以找到 $(SRCROOT), $(PRODUCT_NAME) ... 的定义.

mac app 与 ios app 通过 usb 传输数据的 demo:
https://github.com/rsms/peertalk


需要有自己定义的结构, 如果没有, 但使用了其他框架的结构. 那么, 在更换框架的时候, 就需要重新创建结构并修改使用到这些结构的代码了.

`#include <Fire.h>`, 符号"< >" 会查找指定的头文件目录, 并且如果有多处引用这个头文件, 则只添加一次.

钩子, 伏笔, 插眼, 挖坑, 回调, 生命周期.

---

## 2019.06.08

TODO:

- [ ] 熟悉 Lua, C 与 Lua 的交互.
- [ ] 熟悉 C/C++
- [ ] 熟悉 Cocos2dx
- [ ] 熟悉 ImGui


.gitignore文件

```
# 忽略所有文件
/*

# 不忽略这个文件, ! 开头
!readme.md
```

可以在不同目录下, 创建 .gitignore 文件.

<br/>

> YMMV, Your mileage may vary, 见仁见智

FFI library, 使 lua 可以使用 c 语言

<br/>

**std::forward**

```c
template<typename T, typename... Args>
void printIt(T t, Args&&... args)
{
	printIt(t);
	printIt(std::forward<Args>(args)...);
}

template<> void printIt<double>(double t) { std::cout << "double t = " << t << std::endl; }
template<> void printIt<int>(int t) { std::cout << "int t = " << t << std::endl; }
template<> void printIt<std::string>(std::string t) { std::cout << "string t = " << t.c_str() << std::endl; }

// 测试
printIt(100.0, 80, std::string("well done"));

// 结果
double t = 100
int t = 80
string t = well done

```

可以参照 makefile 文件, 创建工程文件.

---

## 2019.06.07

用于渲染的底层库(创建窗口系统)

> underlying backend (SDL, GLFW, X11, ...)

发现一个更好的 GUI库, [imgui](https://github.com/ocornut/imgui)

- [cocos2dx + imgui](https://github.com/c0i/imguix)

<br/>

I want to use lua, shader, cocos and imgui. So I need a bundled develop environment:

*Lua + Cocos2dx + ImGUI*

With this environment, I can write lua, c, glsl.

**Need some skill to communicate lua with c/c++.**

<br/>

cocos2dx 的 vs 工程里, 自定义生成步骤(Custom Build Step)的内容:

```cmd
if not exist "$(LocalDebuggerWorkingDirectory)" mkdir "$(LocalDebuggerWorkingDirectory)"
xcopy /Y /Q "$(OutDir)*.dll" "$(LocalDebuggerWorkingDirectory)"
xcopy "$(ProjectDir)..\..\..\res" "$(LocalDebuggerWorkingDirectory)\Resources\res\" /D /E /I /F /Y
xcopy "$(ProjectDir)..\..\..\src" "$(LocalDebuggerWorkingDirectory)\Resources\src\" /D /E /I /F /Y
```

---

## 2019.06.06

mac 终端展示时间, `+` 需要添加到最前面.

```bash
date "+DATE: %Y-%m-%d%nTIME: %H:%M:%S"
# 结果:
# DATE: 2019-06-06
# TIME: 06:26:42

date "+%Y-%m-%d_%H:%M:%S"
# 结果:
# 2019-06-06_06:29:38
```

cmd 显示时间

```cmd
DATE /T
REM 结果:
REM 2019/06/06 周四

TIME /T
REM 结果:
REM 10:21

ECHO %date%
REM 结果:
REM 2019/06/06 周四

ECHO %time%
REM 结果:
REM 10:22:09.29

REM ======================================
REM %date:~x,y%, 从 x 开始, 截取 y 个元素
REM ======================================

REM 截取从0开始的4个元素
ECHO %date:~0,4%
REM 结果:
REM 2019

ECHO %date:~0,4%%date:~5,2%%date:~8,2%%time:~0,2%%time:~3,2%%time:~6,2%
REM 结果:
REM 20190606102421
```

```c
struct Color {
    float r; float g; float b; float a;
} c;

// 对结构体赋值
c = { 0.8f, 0.6f, 0.5f, 0.7f };
```

使用 union:

```c
struct Vec4 { float x; float y; float z; float w; };

struct Variable {
    union {
        int i;
        double d;
        char buffer[100];
        struct Vec4 xyzw;
        string s;
    };

    Variable():s("") {}
    Variable(const Variable& v) { *this = v; }
    Variable(Variable&& v) { *this = v; }
    ~Variable() { s.clear(); }

    Variable& operator=(const Variable& v) {
    	memcpy(this, &v, sizeof(v));
    	//s = v.s;
    	return *this;
    }
    Variable& operator=(Variable&& v) {
    	*this = v;
    	return *this;
    }
} ;

struct Variable value;

value.i = 1010;
cout << "value.i " << value.i << endl;

value.d = 3.1415926;
cout << "value.d " << value.d << endl;

strcpy(value.buffer, "be good");
cout << "value.buffer " << value.buffer << endl;

value.xyzw = { 1.1f, 2.2f, 3.3f, 4.5f };
cout << "value.xyzw " << value.xyzw.x << " " << value.xyzw.y << " " << value.xyzw.z << " " << value.xyzw.w << endl;

value.s = "qwertyuiop";
cout << "value.s " << value.s.c_str() << endl;

cout << "sizeof value " << sizeof(value) << endl;

```

实现数据驱动前, 需要先定义结构.

---

## 2019.06.05

使用 `XCOPY` 复制文件前, 确认目录是已经创建的.

```cmd
SET backupPath=D:\PATH\TO\BACKUP
SET XCOPYArgs=/Y /I

MKDIR %backupPath%

XCOPY main.cpp %backupPath% %XCOPYArgs%
XCOPY *.vs %backupPath% %XCOPYArgs%
XCOPY *.fs %backupPath% %XCOPYArgs%

PAUSE
```

---

## 2019.06.04


glfw, 如果一直按着空格, 这个判断为真:

```c
if (glfwGetKey(window, GLFW_KEY_SPACE) == GLFW_PRESS) {
    // ...
}
```

```lua
-- test cocostudio animation
-- ActionTimeline derived from cocos2d::Action
do
    local path = "csb/xxx.csb";
    local node = cc.CSLoader:createNode(path);
    node:addTo(self):move(display.center)

    local actionTimeline = cc.CSLoader:createTimeline(path);
    --                         (startIndex, loop)
    actionTimeline:gotoFrameAndPlay(0, true);
    node:runAction(actionTimeline);
end
```

---

## 2019.06.03

git 遇到问题: fatal: refusing to merge unrelated histories 的解决方案

```
添加 --allow-unrelated-histories
git merge master --allow-unrelated-histories
```

Linux 的两条命令之间通过分号( ; )连接.

Windows 的两条命令之间通过 & 连接.

<br/>

Visual Studio 2015, 在 Project Properties 面板里的 Build Events => Post-Build Event 添加:

`XCOPY *.vs ..\Debug /Y & XCOPY *.fs ..\Debug /Y`

在Project编译之后, 会自动执行XCOPY命令, 将后缀为.vs, .fs的文件复制到上级Debug目录.

这样, Debug 目录里的 exe 文件运行的时候, 就可以读取到这些文件.

<br/>

Visual Studio 调试时使用的文件路径, 是Project目录.


```lua
-- 打印累计的帧数
local totalFrames = cc.Director:getInstance():getTotalFrames()
print("totalFrames = ", totalFrames)
```


shell / cmd 是使用操作系统的一种方式.


C语言 宏 里的 #, #@

```c
// #@: 转换为字符, 两边加单引号('), 'val'. Visual Studio 里有效.
#define _C(val) #@val

// #: 转换为字符串, 两边加双引号("), "val"
#define _S(val) #val

// val 转换为 "val\n". 如果val是宏, 则扩展它.
#define LN(val) _S(val)"\n"

const char* a1 = LN(stpq);
printf("a1 len = %lu\n", strlen(a1)); // a1 len = 5
printf("a1 = %s", a1); // a1 = stpq

char buffer[5] = "";
buffer[0] = _C(x);
buffer[1] = _C(y);
buffer[2] = _C(z);
buffer[3] = _C(w);
printf("buffer = %s\n", buffer); // buffer = xyzw
```

---

## 2019.06.02

如果需要删除 git 的所有历史记录, 可以执行:

```bash
#1. 切换到新的分支, 注意 --orphan 参数.
git checkout --orphan latest_branch

#2. 暂存所有文件.
git add .

#3. 提交.
git commit -m "1"

#4. 删除 master 分支.
git branch -D master

#5. 将新分支命名为 master.
git branch -m master

#6. 推送到远程master分支, 注意 -f 参数.
git push -f origin master

```

之后, 可以执行以下命令, 删掉本地的历史记录(通过`git log`可以看到):

```
git reflog expire --expire=now --all
git gc --prune=now
git gc --aggressive --prune=now
```

---

## 2019.06.01


默认情况下, cocos2dx 的 layer 添加到 node, layer的左下角会与node的左下角重合.


```cmd
batch 打zip包

REM
REM   exe path                     type   filename  password  filelist
"C:\Program Files\7-Zip\7z.exe" a -tzip archive.zip -pzip18 GameData GameData_5Dragons patch runtime cfg-svr.json config.json SkinCFG.json UserDefault.xml
PAUSE
```


ccui.Button 加载图片

```lua
self.BtnStarRun:loadTextureNormal("5DragonsRes/Dragons_Button_2.png")
```

`checkViewReady()`, 检测界面是否就绪, 如果是, 进行下一步, 否则等待(loading).


接触 UI 系统需要了解: 使用流程, 基础控件(组件), 布局, 事件, 自定义控件.

